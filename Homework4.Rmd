---
title: "Homework 4"
author: "Luke Todd"
date: "2023-05-26"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Loading Packages
```{r}
library(here)
library(tidyverse)
library(car)
library(sqldf)
library(janitor)
library(ggthemes)
library(naniar)
library(performance)
library(flextable)
library(broom)
library(ggeffects)
```

# Loading data
```{r}
raw_data <- read_csv(here('ntl6_v12.csv'))
```

# Problem 1
Mathematical:  
H0: $\beta_1$ = 0  
H1: $\beta_1$ != 0  

Biological:  
H0: Fish length is not a significant predictor of fish weight for trout perch.  
H1: Fish length is a significant predictor of fish weight for trout perch.  

# Problem 2
```{r}
# cleaning data
fish_data <- sqldf("SELECT year4, spname, length, weight FROM raw_data
                    WHERE spname = 'TROUTPERCH'")

# missing data viz
vis_miss(fish_data)
```

Figure 1: This figure shows that there are no missing values for year4, spname, and length, but 41% of the data is missing for weight.

# Problem 3
```{r}
fish_lm <- lm(weight ~ length, data = fish_data) # linear model
fish_res <- fish_lm$residuals # calc residuals
```

# Problem 4
```{r, fig.height=6, fig.width=7}
par(mfrow = c(2,2)) # plots two next to each other
plot(fish_lm) # plotting
```
Figure 2: This figure contains four different diagnostic plots.

# Problem 5
The residuals vs. fitted plot shows linearity and constant variance. Based on the plot, the points seem to be randomly distributed.  

The QQ norm plot is used to test if a dataset is normally distributed. Based on the plot, it appears to be normally distributed.  

The scale location plot is used to show homoscedasticity of variance. Based on the plot, the data seems to be randomly distributed.  

The residuals vs. leverage shows influential data points. Based on the plot, there appear to be some high leverage points.  

# Problem 6
```{r}
summary(fish_lm)
```




